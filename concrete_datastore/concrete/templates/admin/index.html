{% extends "admin/index.html" %}
{% load i18n admin_urls static admin_list %}
{% block content %}
<div id="loading-component" style="display: none;text-align: center;">
    <h1>Loading data</h1>
    <div class="loader" style="margin: 0 auto;"></div>
</div>
<div id="content-main"class="module">
    {% if enable_db_dump %}
    <a href="{% url 'concrete:dump_data' %}" onclick="showWaitingDiv()"><u>Show JSON database dump</u></a> | <a href="{% url 'concrete:dump_data' %}?download=true"><u>Download JSON database dump file</u></a><br><br>
    {% endif %}
    {% if enable_db_load %}
        <form action="{% url 'concrete:load_data' %}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div>
                <label>Select a json dump: </label>
                <input type="file" name="json_dump_file" accept=".json">
            </div>
            <button type="submit" onclick="showWaitingDiv()">Submit</button>
        </form><br><br>
        <script type="text/javascript">
            function showWaitingDiv() {
                // Show waiting component
                document.getElementById('loading-component').style.display = "block";
                // Hide other contents
                document.getElementById('content-main').style.display = "none";
                document.getElementById('content-related').style.display = "none";
            }
        </script>
    {% endif %}
{% if use_core_automation %}
<button class="btn btn-primary" style="background: #79aec8;padding: 10px 15px;border: none;border-radius: 4px;color: #fff;cursor: pointer;" onclick="window.location.href='{{target_admin_view}}';">Go to {{target_admin_view_name}}</button>
<br>
<br>
{% endif %}
{% if app_list %}
    {% for models_group in app_list %}
        <div class="app-{{ models_group.app_label }} module">
        <table>
        {% if models_group.group_name %}
        <caption>{{ models_group.group_name }}</caption>
        {% else %}
        <caption>{{ models_group.name }}</caption>
        {% endif %}
        {% for model in models_group.models %}
            <tr class="model-{{ model.object_name|lower }}">
            {% if model.admin_url %}
                <th scope="row"><a href="{{ model.admin_url }}">{{ model.name }}</a></th>
            {% else %}
                <th scope="row">{{ model.name }}</th>
            {% endif %}

            {% if model.add_url %}
                <td><a href="{{ model.add_url }}" class="addlink">{% trans 'Add' %}</a></td>
            {% else %}
                <td>&nbsp;</td>
            {% endif %}

            {% if model.admin_url %}
                {% if model.view_only %}
                <td><a href="{{ model.admin_url }}" class="viewlink">{% trans 'View' %}</a></td>
                {% else %}
                <td><a href="{{ model.admin_url }}" class="changelink">{% trans 'Change' %}</a></td>
                {% endif %}
            {% else %}
                <td>&nbsp;</td>
            {% endif %}
            </tr>
        {% endfor %}
        </table>
        </div>
    {% endfor %}
{% else %}
    <p>{% trans "You don't have permission to view or edit anything." %}</p>
{% endif %}
</div>
{% endblock %}
